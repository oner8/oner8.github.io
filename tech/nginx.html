<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="DAN.yu"><title>Nginxè®¾ç½®åå‘ä»£ç†å†…ç½‘æœåŠ¡å™¨ Â· å®‰ä¸æ˜Ÿæ²³</title><meta name="description" content="Nginx æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„é«˜æ€§èƒ½Webå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå®ƒå…·æœ‰å¾ˆå¤šéå¸¸ä¼˜è¶Šçš„ç‰¹æ€§ï¼Œæœ¬æ¬¡ä¸»è¦è§£å†³Nginxåå‘ä»£ç†è®¾ç½®é—®é¢˜ã€‚å‡å®šæœ‰ä¸€å°èƒ½æ­£å¸¸è®¿é—®çš„å¤–ç½‘NginxæœåŠ¡å™¨Aå’Œä¸€å°å†…ç½‘NginxæœåŠ¡å™¨Bï¼ŒæœåŠ¡"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="manifest" href="/images/site.webmanifest"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/oner8/cdn@latest/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script><meta name="generator" content="Hexo 4.2.0"></head><body><span class="donate-address">å”¯ä¸€æŒ‡å®šé‚®ç®±ï¼ši#wrdan.com</span><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">ç§¯åœŸè€Œä¸ºå±±ï¼Œç§¯æ°´è€Œä¸ºæµ·</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">å®‰ä¸æ˜Ÿæ²³</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">é¦–é¡µ</a></li><li><a href="/archives">å½’æ¡£</a></li><li><a href="/categories">åˆ†ç±»</a></li><li><a href="/tags">æ ‡ç­¾</a></li><li><a href="/links.html">å‹é“¾</a></li><li><a href="/about.html">å…³äº</a></li><li class="soc"><a href="https://github.com/wrdan" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a><a href="https://twitter.com/dannyw" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter">&nbsp;</i></a><a href="https://wrdan.com/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2020&nbsp;<a target="_blank" href="https://wrdan.com" rel="noopener noreferrer">DAN.yu</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>Nginxè®¾ç½®åå‘ä»£ç†å†…ç½‘æœåŠ¡å™¨</a></p><p class="post-meta"><span class="meta-item"><i class="fa fa-calendar"></i><span>&nbsp;</span><span title="æ›´æ–°æ—¶é—´" class="meta-item">2017-04-21</span></span><span class="meta-item"><i class="fa fa-keyboard-o"></i><span>&nbsp;</span><span title="å­—æ•°ç»Ÿè®¡" class="meta-item">693</span></span><span class="meta-item"><i class="fa fa-hourglass-o"></i><span>&nbsp;</span><span title="é˜…è¯»æ—¶é•¿" class="meta-item">3</span></span><span class="meta-item"><i class="fa fa-folder-open-o"></i><span>&nbsp;</span><a href="/categories/tech/" title="tech" class="a-tag">tech</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/Nginxåå‘ä»£ç†/" title="Nginxåå‘ä»£ç†" class="a-tag">Nginxåå‘ä»£ç†</a><span>&nbsp;</span></span></p><p class="post-abstract"><p>Nginx æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„é«˜æ€§èƒ½Webå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå®ƒå…·æœ‰å¾ˆå¤šéå¸¸ä¼˜è¶Šçš„ç‰¹æ€§ï¼Œæœ¬æ¬¡ä¸»è¦è§£å†³Nginxåå‘ä»£ç†è®¾ç½®é—®é¢˜ã€‚<br>å‡å®šæœ‰ä¸€å°èƒ½æ­£å¸¸è®¿é—®çš„å¤–ç½‘NginxæœåŠ¡å™¨Aå’Œä¸€å°å†…ç½‘NginxæœåŠ¡å™¨Bï¼ŒæœåŠ¡å™¨Aèƒ½è®¿é—®åˆ°æœåŠ¡å™¨Bï¼Œè€Œå¤–ç½‘ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—®åˆ°æœåŠ¡å™¨Bã€‚ç°åœ¨é€šè¿‡æœåŠ¡å™¨Aé…ç½®Nginxåå‘ä»£ç†æœåŠ¡å™¨Bä»è€Œå®ç°å¤–ç½‘ç”¨æˆ·è®¿é—®åˆ°å†…ç½‘æœåŠ¡å™¨ã€‚<br>é…ç½®åå‘ä»£ç†</p>
<p>1.å°†åŸŸåtest.wrdan.comè§£æåˆ°æœåŠ¡å™¨A</p>
<p>2.åœ¨æœåŠ¡å™¨Aæ·»åŠ ä¸€ä¸ªè™šæ‹Ÿä¸»æœº</p>
<pre><code>server {
    listen 80;
    server_name test.wrdan.com;
    index index.php;

    location / {
        proxy_redirect off; #å…³é—­é‡å®šå‘

        #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP
        proxy_set_header Host $host; #å°†è¯·æ±‚å¤´å‘é€åˆ°å†…ç½‘æœåŠ¡å™¨
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://192.168.1.2:80; #è®¾ç½®å†…ç½‘æœåŠ¡å™¨è®¿é—®åœ°å€

        client_max_body_size 100m; #å®¢æˆ·ç«¯å…è®¸ä¸Šä¼ çš„æœ€å¤§æ–‡ä»¶å¤§å°
        client_body_buffer_size 128k; #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°

        proxy_connect_timeout 5; #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´
        proxy_read_timeout 60; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´
        proxy_send_timeout 5; #åç«¯æœåŠ¡å™¨å‘é€æ—¶é—´

        proxy_buffer_size 4k; #è®¾ç½®nginxä»£ç†æœåŠ¡å™¨ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°
        proxy_buffers 4 32k; #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ï¼Œè¿™æ ·è®¾ç½®
        proxy_busy_buffers_size 64k; #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰
        proxy_temp_file_write_size 64k; #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ é€’è¯·æ±‚ï¼Œè€Œä¸ç¼“å†²åˆ°ç£ç›˜
        proxy_ignore_client_abort on; #ä¸å…è®¸ä»£ç†ç«¯ä¸»åŠ¨å…³é—­è¿æ¥
    }

    access_log off; #å…³é—­æ—¥å¿—
}</code></pre><p>3.ç¡®ä¿æœåŠ¡å™¨Båœ¨å†…ç½‘èƒ½ç”¨åŸŸåtest.wrdan.comæ­£å¸¸è®¿é—®ã€‚</p>
<p>4.å¦‚æœéœ€è¦æ‰“å¼€æ—¥å¿—ï¼Œåœ¨æœåŠ¡å™¨Bä¸Šè¿™ä¹ˆè®¾ç½®</p>
<pre><code>log_format access &#39;$http_x_real_ip - $remote_user [$time_local] &quot;$request&quot; &#39;
                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;
                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;

access_log /var/log/nginx/access.log access;</code></pre><p>é»˜è®¤çš„æ—¥å¿—è®¾ç½®æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code>log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;
                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;
                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;

access_log  /var/log/nginx/access.log  main;</code></pre><p>5.å°è¯•ä»å¤–ç½‘è®¿é—®ã€‚</p>
<p>Nginxä¼˜åŒ–è®¾ç½®</p>
<p>å¤§éƒ¨åˆ†è®¾ç½®é¡¹æ¥è‡ªlnmp.org</p>
<pre><code>http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;
                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;
                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;

    #access_log  /var/log/nginx/access.log  main;
    access_log off;

    sendfile        on;
    server_names_hash_bucket_size 128;
    client_header_buffer_size 32k;
    large_client_header_buffers 4 32k;
    client_max_body_size 50m;
    tcp_nopush on;

    keepalive_timeout  65;

    fastcgi_connect_timeout 300;
    fastcgi_send_timeout 300;
    fastcgi_read_timeout 300;
    fastcgi_buffer_size 64k;
    fastcgi_buffers 4 64k;
    fastcgi_busy_buffers_size 128k;
    fastcgi_temp_file_write_size 256k;

    gzip on;
    gzip_min_length  1k;
    gzip_buffers     4 16k;
    gzip_http_version 1.1;
    gzip_comp_level 2;
    gzip_types     text/plain application/javascript application/x-javascript text/javascript text/css application/xml application/xml+rss;
    gzip_vary on;
    gzip_proxied   expired no-cache no-store private auth;
    gzip_disable   &quot;MSIE [1-6]\.&quot;;

    include conf.d/*.conf;
    include vhost/*.conf;
}</code></pre></p></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/share/aliyun-yiyuan.html" title="é˜¿é‡Œäº‘æŠ½å¥–1å…ƒä½“éªŒLinux Windows è™šæ‹Ÿä¸»æœºä¸€å¹´ï¼ˆç³»ç»Ÿå¯éšæ„åˆ‡æ¢ï¼‰"><i class="fa fa-angle-double-left"></i>&nbsp;ä¸Šä¸€ç¯‡: é˜¿é‡Œäº‘æŠ½å¥–1å…ƒä½“éªŒLinux Windows è™šæ‹Ÿä¸»æœºä¸€å¹´ï¼ˆç³»ç»Ÿå¯éšæ„åˆ‡æ¢ï¼‰</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/share/Symantec-to-Comodo.html" title="Symantec SSLè¯ä¹¦å…è´¹æ›¿æ¢æˆ3å¹´Comodo SSLè¯ä¹¦">ä¸‹ä¸€ç¯‡: Symantec SSLè¯ä¹¦å…è´¹æ›¿æ¢æˆ3å¹´Comodo SSLè¯ä¹¦&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div><a id="comments"></a><div id="valine-container"></div><script>(function(){
    if(typeof Valine !== 'undefined'){
        new Valine({
            el:'#valine-container',
            appId: 'SphQyGolSRFHnBWzGGz4XeLE-gzGzoHsz',
            appKey: 'gMqbeGAx90w5NF4G4R43I0UD',
            placeholder: 'å¿«æ¥è¯„è®ºå§ğŸ˜€',
            path: window.location.pathname
        })
    }
}())
</script></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2020&nbsp;<a target="_blank" href="https://wrdan.com" rel="noopener noreferrer">DAN.yu</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.1.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-migrate@1.2.1/dist/jquery-migrate.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery.appear@latest/jquery.appear.min.js"></script><script src="https://cdn.jsdelivr.net/gh/oner8/cdn@latest/js/google-analytics.js"></script><script src="https://cdn.jsdelivr.net/gh/oner8/cdn@latest/js/typography.min.js"></script></body></html>